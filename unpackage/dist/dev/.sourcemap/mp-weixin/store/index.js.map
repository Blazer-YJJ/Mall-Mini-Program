{"version":3,"file":"index.js","sources":["store/index.js"],"sourcesContent":["/*\n * @Author: JingChengCool jingchengcool@outlook.com\n * @Date: 2025-02-28 01:51:13\n * @LastEditors: JingChengCool jingchengcool@outlook.com\n * @LastEditTime: 2025-02-28 04:48:26\n * @FilePath: \\Mall-Mini-Program\\store\\index.js\n * @Description: 这是默认设置,请设置`customMade`, 打开koroFileHeader查看配置 进行设置: https://github.com/OBKoro1/koro1FileHeader/wiki/%E9%85%8D%E7%BD%AE\n */\nimport { createStore } from 'vuex'\n\nconst store = createStore({\n  state: {\n    // 用户信息\n    userInfo: uni.getStorageSync('userInfo') || null,\n    // 购物车数据\n    cartList: uni.getStorageSync('cartList') || [],\n    // 收货地址列表\n    addressList: uni.getStorageSync('addressList') || []\n  },\n  mutations: {\n    // 设置用户信息\n    setUserInfo(state, userInfo) {\n      state.userInfo = userInfo\n      uni.setStorageSync('userInfo', userInfo)\n    },\n    // 添加商品到购物车\n    addToCart(state, goods) {\n      const index = state.cartList.findIndex(item => item.id === goods.id)\n      if (index > -1) {\n        state.cartList[index].count += 1\n      } else {\n        state.cartList.push({\n          ...goods,\n          count: 1,\n          checked: true\n        })\n      }\n      uni.setStorageSync('cartList', state.cartList)\n    },\n    // 更新购物车商品数量\n    updateCartCount(state, { id, count }) {\n      const index = state.cartList.findIndex(item => item.id === id)\n      if (index > -1) {\n        state.cartList[index].count = count\n      }\n      uni.setStorageSync('cartList', state.cartList)\n    },\n    // 删除购物车商品\n    removeFromCart(state, id) {\n      const index = state.cartList.findIndex(item => item.id === id)\n      if (index > -1) {\n        state.cartList.splice(index, 1)\n      }\n      uni.setStorageSync('cartList', state.cartList)\n    },\n    // 设置收货地址列表\n    setAddressList(state, addressList) {\n      state.addressList = addressList\n      uni.setStorageSync('addressList', addressList)\n    },\n    // 更新购物车商品选中状态\n    updateCartItemChecked(state, { id, checked }) {\n      const index = state.cartList.findIndex(item => item.id === id)\n      if (index > -1) {\n        state.cartList[index].checked = checked\n      }\n      uni.setStorageSync('cartList', state.cartList)\n    },\n    // 更新所有购物车商品的选中状态\n    updateAllCartItemsChecked(state, checked) {\n      state.cartList.forEach(item => {\n        item.checked = checked\n      })\n      uni.setStorageSync('cartList', state.cartList)\n    }\n  },\n  actions: {\n    // 异步操作可以在这里处理\n    // 初始化应用数据\n    initAppData({ commit }) {\n      // 从本地存储加载数据\n      const userInfo = uni.getStorageSync('userInfo')\n      const cartList = uni.getStorageSync('cartList')\n      const addressList = uni.getStorageSync('addressList')\n      \n      if (userInfo) commit('setUserInfo', userInfo)\n      if (cartList) {\n        // 直接更新购物车数据，而不是使用不存在的setCartList mutation\n        cartList.forEach(item => {\n          commit('addToCart', item)\n        })\n      }\n      if (addressList) commit('setAddressList', addressList)\n    }\n  },\n  getters: {\n    // 购物车商品总数\n    cartCount: state => {\n      return state.cartList.reduce((total, item) => total + item.count, 0)\n    },\n    // 购物车商品总价\n    cartTotal: state => {\n      return state.cartList.reduce((total, item) => total + item.price * item.count, 0)\n    }\n  }\n})\n\nexport default store"],"names":["createStore","uni"],"mappings":"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"}