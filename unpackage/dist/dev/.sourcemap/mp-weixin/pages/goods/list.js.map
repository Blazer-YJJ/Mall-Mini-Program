{"version":3,"file":"list.js","sources":["pages/goods/list.vue","D:/install_project/HBuilderX.4.29.2024093009/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvZ29vZHMvbGlzdC52dWU"],"sourcesContent":["<template>\n  <view class=\"goods-list-container\">\n    <view class=\"search-box\">\n      <u-search v-model=\"keyword\" placeholder=\"搜索商品\" @search=\"handleSearch\" />\n    </view>\n    <view class=\"category-box\">\n      <scroll-view scroll-x class=\"category-scroll\">\n        <view class=\"category-item\" v-for=\"item in categories\" :key=\"item.id\" @click=\"selectCategory(item)\" :class=\"{active: currentCategory === item.id}\">\n          {{ item.name }}\n        </view>\n      </scroll-view>\n    </view>\n    <view class=\"filter-box\">\n      <view class=\"filter-item\" :class=\"{active: sortType === 'default'}\" @click=\"changeSort('default')\">\n        <text>默认</text>\n      </view>\n      <view class=\"filter-item\" :class=\"{active: sortType === 'sales'}\" @click=\"changeSort('sales')\">\n        <text>销量</text>\n      </view>\n      <view class=\"filter-item\" @click=\"changeSort('price')\">\n        <text>价格</text>\n        <view class=\"sort-icon\">\n          <u-icon :name=\"sortType === 'price_asc' ? 'arrow-up-fill' : 'arrow-up'\" size=\"12\" color=\"#999\"></u-icon>\n          <u-icon :name=\"sortType === 'price_desc' ? 'arrow-down-fill' : 'arrow-down'\" size=\"12\" color=\"#999\"></u-icon>\n        </view>\n      </view>\n      <view class=\"filter-item\" @click=\"showPriceFilter = true\">\n        <text>筛选</text>\n        <u-icon name=\"filter\" size=\"14\"></u-icon>\n      </view>\n    </view>\n    <view class=\"goods-list\">\n      <view class=\"goods-item\" v-for=\"item in goodsList\" :key=\"item.id\" @click=\"goToDetail(item)\">\n        <image :src=\"item.image\" mode=\"aspectFill\" class=\"goods-image\"></image>\n        <view class=\"goods-info\">\n          <view class=\"tags\" v-if=\"item.tags && item.tags.length\">\n            <text class=\"tag\" v-for=\"(tag, index) in item.tags\" :key=\"index\">{{tag}}</text>\n          </view>\n          <text class=\"goods-name\">{{ item.name }}</text>\n          <view class=\"price-box\">\n            <text class=\"goods-price\">¥{{ item.price }}</text>\n            <text class=\"goods-sales\">已售{{item.sales || 0}}件</text>\n          </view>\n        </view>\n      </view>\n    </view>\n    <u-loadmore :status=\"loadStatus\" />\n    \n    <!-- 价格筛选弹窗 -->\n    <u-popup v-model=\"showPriceFilter\" mode=\"bottom\" height=\"300\">\n      <view class=\"price-filter\">\n        <view class=\"filter-header\">\n          <text>价格区间</text>\n          <u-icon name=\"close\" @click=\"showPriceFilter = false\"></u-icon>\n        </view>\n        <view class=\"price-range\">\n          <input type=\"number\" v-model=\"minPrice\" placeholder=\"最低价\" />\n          <text>-</text>\n          <input type=\"number\" v-model=\"maxPrice\" placeholder=\"最高价\" />\n        </view>\n        <view class=\"quick-range\">\n          <view class=\"range-item\" v-for=\"(range, index) in priceRanges\" :key=\"index\" @click=\"selectPriceRange(range)\">\n            {{range.text}}\n          </view>\n        </view>\n        <view class=\"filter-btns\">\n          <u-button @click=\"resetFilter\">重置</u-button>\n          <u-button type=\"primary\" @click=\"confirmFilter\">确定</u-button>\n        </view>\n      </view>\n    </u-popup>\n  </view>\n</template>\n\n<script>\nexport default {\n  data() {\n    return {\n      keyword: '',\n      currentCategory: null,\n      categories: [\n        { id: 1, name: '全部' },\n        { id: 2, name: '手机数码' },\n        { id: 3, name: '家用电器' },\n        { id: 4, name: '服装鞋包' },\n        { id: 5, name: '食品生鲜' },\n        { id: 6, name: '美妆个护' },\n        { id: 7, name: '母婴玩具' },\n        { id: 8, name: '家居日用' }\n      ],\n      goodsList: [],\n      page: 1,\n      loadStatus: 'loadmore',\n      sortType: 'default',\n      showPriceFilter: false,\n      minPrice: '',\n      maxPrice: '',\n      priceRanges: [\n        { text: '0-100', min: 0, max: 100 },\n        { text: '100-500', min: 100, max: 500 },\n        { text: '500-1000', min: 500, max: 1000 },\n        { text: '1000以上', min: 1000, max: 999999 }\n      ],\n      filterPrice: null\n    }\n  },\n  onLoad() {\n    this.loadGoodsList()\n  },\n  onReachBottom() {\n    if (this.loadStatus === 'loadmore') {\n      this.page++\n      this.loadGoodsList()\n    }\n  },\n  methods: {\n    async loadGoodsList() {\n      try {\n        // 模拟商品数据\n        let mockGoods = Array(10).fill().map((_, index) => ({\n          id: this.page * 10 + index,\n          name: `商品${this.page * 10 + index}`,\n          price: Math.floor(Math.random() * 1000 + 100),\n          image: '/static/logo.png',\n          sales: Math.floor(Math.random() * 500),\n          tags: this.generateRandomTags()\n        }))\n        \n        // 应用价格筛选\n        if (this.filterPrice) {\n          mockGoods = mockGoods.filter(item => \n            item.price >= this.filterPrice.min && item.price <= this.filterPrice.max\n          )\n        }\n        \n        // 应用排序\n        mockGoods = this.applySorting(mockGoods)\n        \n        if (this.page === 1) {\n          this.goodsList = mockGoods\n        } else {\n          this.goodsList = [...this.goodsList, ...mockGoods]\n        }\n        \n        this.loadStatus = mockGoods.length < 10 ? 'nomore' : 'loadmore'\n      } catch (error) {\n        this.loadStatus = 'loadmore'\n        uni.showToast({\n          title: '加载失败',\n          icon: 'none'\n        })\n      }\n    },\n    \n    // 生成随机标签\n    generateRandomTags() {\n      const allTags = ['新品', '热销', '促销', '限时', '包邮', '满减']\n      const tags = []\n      const count = Math.floor(Math.random() * 3) // 0-2个标签\n      \n      for (let i = 0; i < count; i++) {\n        const randomIndex = Math.floor(Math.random() * allTags.length)\n        if (!tags.includes(allTags[randomIndex])) {\n          tags.push(allTags[randomIndex])\n        }\n      }\n      \n      return tags\n    },\n    \n    // 应用排序\n    applySorting(goods) {\n      switch(this.sortType) {\n        case 'sales':\n          return goods.sort((a, b) => b.sales - a.sales)\n        case 'price_asc':\n          return goods.sort((a, b) => a.price - b.price)\n        case 'price_desc':\n          return goods.sort((a, b) => b.price - a.price)\n        default:\n          return goods\n      }\n    },\n    handleSearch() {\n      this.page = 1\n      this.loadGoodsList()\n    },\n    selectCategory(category) {\n      this.currentCategory = category.id\n      this.page = 1\n      this.loadGoodsList()\n    },\n    goToDetail(goods) {\n      uni.navigateTo({\n        url: `/pages/goods/detail?id=${goods.id}`\n      })\n    },\n    \n    // 改变排序方式\n    changeSort(type) {\n      if (type === 'price') {\n        // 价格排序特殊处理，点击一次升序，再点击一次降序\n        if (this.sortType === 'price_asc') {\n          this.sortType = 'price_desc'\n        } else {\n          this.sortType = 'price_asc'\n        }\n      } else {\n        this.sortType = type\n      }\n      \n      this.page = 1\n      this.loadGoodsList()\n    },\n    \n    // 选择价格区间\n    selectPriceRange(range) {\n      this.minPrice = range.min\n      this.maxPrice = range.max\n    },\n    \n    // 确认价格筛选\n    confirmFilter() {\n      const min = Number(this.minPrice) || 0\n      const max = Number(this.maxPrice) || 999999\n      \n      this.filterPrice = { min, max }\n      this.showPriceFilter = false\n      this.page = 1\n      this.loadGoodsList()\n    },\n    \n    // 重置价格筛选\n    resetFilter() {\n      this.minPrice = ''\n      this.maxPrice = ''\n      this.filterPrice = null\n      this.page = 1\n      this.loadGoodsList()\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.goods-list-container {\n  .search-box {\n    padding: 20rpx;\n    background-color: #fff;\n  }\n  .category-box {\n    background-color: #fff;\n    padding: 20rpx 0;\n    .category-scroll {\n      white-space: nowrap;\n      .category-item {\n        display: inline-block;\n        padding: 10rpx 30rpx;\n        margin: 0 20rpx;\n        border-radius: 30rpx;\n        font-size: 28rpx;\n        color: #666;\n        background-color: #f5f5f5;\n        &.active {\n          color: #fff;\n          background-color: #2979ff;\n        }\n      }\n    }\n  }\n  .filter-box {\n    display: flex;\n    align-items: center;\n    background-color: #fff;\n    padding: 20rpx;\n    margin-bottom: 20rpx;\n    border-bottom: 1rpx solid #f5f5f5;\n    \n    .filter-item {\n      flex: 1;\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      font-size: 28rpx;\n      color: #666;\n      position: relative;\n      \n      &.active {\n        color: #2979ff;\n        font-weight: bold;\n      }\n      \n      .sort-icon {\n        display: flex;\n        flex-direction: column;\n        margin-left: 6rpx;\n      }\n    }\n  }\n  .goods-list {\n    padding: 20rpx;\n    display: flex;\n    flex-wrap: wrap;\n    justify-content: space-between;\n    .goods-item {\n      width: 345rpx;\n      margin-bottom: 20rpx;\n      background-color: #fff;\n      border-radius: 12rpx;\n      overflow: hidden;\n      .goods-image {\n        width: 345rpx;\n        height: 345rpx;\n      }\n      .goods-info {\n        padding: 16rpx;\n        \n        .tags {\n          display: flex;\n          flex-wrap: wrap;\n          margin-bottom: 10rpx;\n          \n          .tag {\n            font-size: 20rpx;\n            color: #ff5500;\n            background-color: rgba(255, 85, 0, 0.1);\n            padding: 2rpx 10rpx;\n            border-radius: 6rpx;\n            margin-right: 10rpx;\n            margin-bottom: 6rpx;\n          }\n        }\n        \n        .goods-name {\n          font-size: 28rpx;\n          color: #333;\n          display: -webkit-box;\n          -webkit-box-orient: vertical;\n          -webkit-line-clamp: 2;\n          overflow: hidden;\n        }\n        \n        .price-box {\n          display: flex;\n          justify-content: space-between;\n          align-items: center;\n          margin-top: 10rpx;\n          \n          .goods-price {\n            font-size: 32rpx;\n            color: #ff5500;\n            font-weight: bold;\n          }\n          \n          .goods-sales {\n            font-size: 22rpx;\n            color: #999;\n          }\n        }\n      }\n    }\n  }\n  \n  .price-filter {\n    padding: 30rpx;\n    \n    .filter-header {\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n      margin-bottom: 30rpx;\n      font-size: 32rpx;\n      font-weight: bold;\n    }\n    \n    .price-range {\n      display: flex;\n      align-items: center;\n      margin-bottom: 30rpx;\n      \n      input {\n        flex: 1;\n        height: 70rpx;\n        border: 1rpx solid #eee;\n        border-radius: 8rpx;\n        padding: 0 20rpx;\n        text-align: center;\n      }\n      \n      text {\n        margin: 0 20rpx;\n        color: #999;\n      }\n    }\n    \n    .quick-range {\n      display: flex;\n      flex-wrap: wrap;\n      margin-bottom: 30rpx;\n      \n      .range-item {\n        width: calc(25% - 15rpx);\n        height: 60rpx;\n        line-height: 60rpx;\n        text-align: center;\n        border: 1rpx solid #eee;\n        border-radius: 8rpx;\n        margin-right: 20rpx;\n        margin-bottom: 20rpx;\n        font-size: 24rpx;\n        color: #666;\n        \n        &:nth-child(4n) {\n          margin-right: 0;\n        }\n        \n        &:active {\n          background-color: #f0f0f0;\n        }\n      }\n    }\n    \n    .filter-btns {\n      display: flex;\n      justify-content: space-between;\n      \n      button {\n        width: 48%;\n      }\n    }\n  }\n}\n</style>","import MiniProgramPage from 'E:/uniapp/Mall-Mini-Program/pages/goods/list.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni"],"mappings":"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"}